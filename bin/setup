#!/bin/sh
set -eux

# stop the app
docker compose down

# ensure that mix dependencies are installed
# ensure that node dependencies are installed
docker compose run --rm --no-deps app \
  mix deps.get && \
  npm install --prefix assets

# set up the app
docker compose run app \
  mix setup

# start the app
docker compose up --detach
